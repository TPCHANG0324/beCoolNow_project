<template>
  <div>
    <MainHeader></MainHeader>
    <div class="aboutus_top_R">
      <div class="aboutus_toptitle_R">
        <video class="background-video" autoplay loop muted playsinline>
        <source src="../assets/videos/bcn.mp4" type="video/mp4">
      </video>
        <h1>é—œæ–¼æˆ‘å€‘</h1>
        <h1>About Us</h1>
      </div>
    </div>
    <div class="wrapper">
      <div class="aboutus_top2_R">
        <h2>æˆ‘å€‘çš„ç†å¿µ</h2>
        <p>
          å…¨çƒæš–åŒ–æ˜¯å…¨äººé¡çš„å…±åŒæŒ‘æˆ°ï¼Œå°è‡ºç£è€Œè¨€æ›´æ˜¯è¿«åœ¨çœ‰ç«ã€‚æ¥µç«¯æ°£å€™é »ç™¼ã€æµ·å¹³é¢ä¸Šå‡ã€ç”Ÿæ…‹å¤±è¡¡ï¼Œ
          æ­£å¨è„…æˆ‘å€‘çš„å®‰å…¨èˆ‡æœªä¾†ã€‚é¢å°é€™å ´æ°£å€™å±æ©Ÿï¼Œè‡ºç£é›–ç„¶æ¸ºå°ï¼Œä½†æˆ‘å€‘æ“æœ‰å‰µæ–°èˆ‡è¡Œå‹•çš„åŠ›é‡ï¼Œéœ€è¦ä½ æˆ‘ä¸€èµ·é—œæ³¨!
        </p>
      </div>
      <div class="aboutus_top3_R">
        <div class="aboutus_top3pic_R">
          <img src="../assets/images/Au02.jpeg" alt="" />
        </div>
        <div class="aboutus_top3word_R">
          <h2>æå€¡ç’°ä¿ç†å¿µ<br/>å®£å‚³æ´»å‹•</h2>
          <p>
            æ¨å‹•ç¶ èƒ½ã€ç’°ä¿è¡Œå‹•ã€å®ˆè­·ç’°å¢ƒï¼Œå¾ç¾åœ¨é–‹å§‹ï¼Œæ¯ä¸€æ­¥éƒ½è‡³é—œé‡è¦ï¼ æˆ‘å€‘ç›¸ä¿¡ï¼Œæ”¹è®Šçš„åŠ›é‡ä¾†è‡ªæ¯ä¸€å€‹äººï¼Œ
            å¾è‡ºç£å‡ºç™¼ï¼Œèˆ‡å…¨çƒåŒè¡Œï¼Œå‰µé€ æ°¸çºŒçš„æœªä¾†ã€‚ è®“æˆ‘å€‘æ”œæ‰‹è¡Œå‹•ï¼Œç‚ºåœ°çƒçš„æ˜å¤©ç™¼è²ï¼
          </p>
        </div>
      </div>
      <div class="aboutus_middle_R">
        <div class="about_middlecard_R">
          <h3>æ”¹è®Šä¸¦éä¸€å¤•ä¹‹é–“ï¼Œæ‹¯æ•‘å”¯ä¸€çš„åœ°çƒå®¶åœ’ä»åˆ»ä¸å®¹ç·©</h3>
          <p>Change doesn't happen overnight, but saving our one and only homeâ€”Earthâ€”remains an urgent priority.</p>
          <h3>ä¸€äººä¹‹åŠ›å›ºç„¶æœ‰é™ï¼Œè«‹æ‚¨ç«‹å³ä¼¸å‡ºæ´æ‰‹<br />è®“æˆ‘å€‘é›†èšäººä¹‹åŠ›ï¼Œæ¨å‹•å…±åŒæœŸç›¼çš„æ”¹è®Šï¼</h3>
          <p>
            One person's power may be limited, but your immediate support can make a difference. Let us unite our
            strength to drive the change we all hope for!
          </p>
          <router-link to="/Support" class="btn">æ”¯æŒæˆ‘å€‘</router-link>
        </div>
      </div>
      <div class="about_bottom_R">
        <h2>è¯çµ¡æˆ‘å€‘</h2>
        <h2>Contact</h2>
        <div class="aboutus_input_R">
          <div class="form-group">
            <p>* å§“å:</p>
            <input class="input" type="text" v-model="name" @blur="validateName" />
            <span v-if="errors.name" class="error-text_about">{{ errors.name }}</span>
          </div>
          <div class="form-group">
            <p>* Email:</p>
            <input class="input" type="email" v-model="email" @blur="validateEmail" />
            <span v-if="errors.email" class="error-text_about">{{ errors.email }}</span>
          </div>
          <div class="form-group">
            <p>* æ‰‹æ©Ÿ:</p>
            <input class="input" type="text" v-model="phone" @blur="validatePhone" />
          <span v-if="errors.phone" class="error-text_about">{{ errors.phone }}</span>
          </div>
          <div class="form-group">
            <p>* æ‚¨çš„å»ºè­°:</p>
            <textarea class="input" rows="4" v-model="message" @blur="validateMessage"></textarea>
          <span v-if="errors.message" class="error-text_about">{{ errors.message }}</span>
          </div>
        </div>
        <button class="btn" @click="submitForm">é€å‡º</button>
      </div>

      <div class="aboutus_lowest_R">
        <h3>éŸ¿æ‡‰ç’°ä¿å¥½å¤¥ä¼´</h3>
        <ul class="aboutus_marquee_R">
          <li>
            <div class="icon-text-wrapper">
              <img src="../assets/images/afakelogo1.png" alt="GitHub" style="width: 80px; height: 80px" />
              <span>æ°¸çºŒç§‘æŠ€å…¬å¸</span>
            </div>
          </li>
          <li>
            <div class="icon-text-wrapper">
              <img src="../assets/images/afakelogo2.png" alt="GitHub" style="width: 80px; height: 80px" />
              <span>ç¶ åŸå»ºç¯‰</span>
            </div>
          </li>
          <li>
            <div class="icon-text-wrapper">
              <img src="../assets/images/afakelogo3.png" alt="Google" style="width: 80px; height: 80px" />
              <span>æ°¸çºŒè¾²æ¥­</span>
            </div>
          </li>
          <li>
            <div class="icon-text-wrapper">
              <img src="../assets/images/afakelogo4.png" alt="Facebook" style="width: 80px; height: 80px" />
              <span>ç¶ èƒ½ç§‘æŠ€</span>
            </div>
          </li>
        </ul>
      </div>
    </div>
    <MainFooter></MainFooter>
  </div>
</template>

<script>
import { RouterLink } from 'vue-router';
import { ref } from 'vue';

export default {

  setup() {
    const base_url = import.meta.env.VITE_AJAX_URL; 
    
    const name = ref('');
    const email = ref('');
    const phone = ref('');
    const message = ref('');
    const errors = ref({
      name: '',
      email: '',
      phone: '',
      message: '',
    });

    // **1ï¸âƒ£ Email é©—è­‰**
    const validateEmail = () => {
      const emailPattern = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
      if (!email.value) {
        errors.value.email = 'è«‹è¼¸å…¥ Email';
      } else if (!emailPattern.test(email.value)) {
        errors.value.email = 'è«‹è¼¸å…¥æœ‰æ•ˆçš„ Email æ ¼å¼';
      } else {
        errors.value.email = '';
      }
    };

    // **2ï¸âƒ£ æ‰‹æ©Ÿé©—è­‰ï¼ˆå°ç£æ ¼å¼ï¼‰**
    const validatePhone = () => {
      const phonePattern = /^09\d{8}$/; // 09 é–‹é ­ + 8 ä½æ•¸å­—
      if (!phone.value) {
        errors.value.phone = 'è«‹è¼¸å…¥æ‰‹æ©Ÿè™Ÿç¢¼';
      } else if (!phonePattern.test(phone.value)) {
        errors.value.phone = 'è«‹è¼¸å…¥æœ‰æ•ˆçš„å°ç£æ‰‹æ©Ÿè™Ÿç¢¼ï¼ˆ09é–‹é ­ï¼Œå…±10ä½æ•¸ï¼‰';
      } else {
        errors.value.phone = '';
      }
    };

    // **3ï¸âƒ£ å§“åé©—è­‰**
    const validateName = () => {
      if (!name.value.trim()) {
        errors.value.name = 'è«‹è¼¸å…¥å§“å';
      } else {
        errors.value.name = '';
      }
    };

    // **4ï¸âƒ£ è¨Šæ¯é©—è­‰**
    const validateMessage = () => {
      if (!message.value.trim()) {
        errors.value.message = 'è«‹è¼¸å…¥æ‚¨çš„å»ºè­°';
      } else {
        errors.value.message = '';
      }
    };

    // **5ï¸âƒ£ è¡¨å–®æäº¤**
    const submitForm = async () => {
      validateName();
      validateEmail();
      validatePhone();
      validateMessage();

      // **å¦‚æœæœ‰éŒ¯èª¤ï¼Œé˜»æ­¢æäº¤**
      if (Object.values(errors.value).some(error => error !== '')) {
        alert('ğŸŒ è«‹å¡«å¯«å®Œæ•´ä¸¦ä¿®æ­£éŒ¯èª¤å¾Œå†é€å‡º');
        return;
      }

      try {
        const response = await fetch(`${base_url}/AuB_addmessage.php`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            name: name.value,
            email: email.value,
            phone: phone.value,
            message: message.value,
          }),
        });

        const result = await response.json();
        if (response.ok) {
          alert('â˜˜ï¸ è¨Šæ¯å·²æˆåŠŸé€å‡ºï¼');

          // **æˆåŠŸå¾Œæ¸…ç©ºè¡¨å–®**
          name.value = '';
          email.value = '';
          phone.value = '';
          message.value = '';
        } else {
          alert('ğŸ‚ é€å‡ºå¤±æ•—: ' + result.error);
        }
      } catch (error) {
        alert('ğŸ‚ æäº¤æ™‚ç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦');
        console.error('ğŸ‚ æäº¤æ™‚ç™¼ç”ŸéŒ¯èª¤:', error);
          }
    };

    return {
      name,
      email,
      phone,
      message,
      errors,
      validateEmail,
      validatePhone,
      validateName,
      validateMessage,
      submitForm,
    };
  },
};
</script>

<style scoped>
.error-text_about {
  color: red;
  font-size: 14px;
  margin-top: 5px;
  display: block;
}
.btn:disabled {
  background-color: #ccc;
  cursor: not-allowed;
}
</style>
